(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();class $t{constructor(){this.listeners=new Map}on(e,t){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),()=>this.off(e,t)}off(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)}emit(e,t){this.listeners.has(e)&&this.listeners.get(e).forEach(i=>{try{i(t)}catch(s){console.error(`Error in event listener for ${e}:`,s)}})}}const v=new $t,Et=Object.freeze(Object.defineProperty({__proto__:null,bus:v},Symbol.toStringTag,{value:"Module"})),de=(n,e)=>e.some(t=>n instanceof t);let De,Be;function zt(){return De||(De=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _t(){return Be||(Be=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ge=new WeakMap,fe=new WeakMap,ae=new WeakMap;function At(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",r),n.removeEventListener("error",o)},r=()=>{t(B(n.result)),s()},o=()=>{i(n.error),s()};n.addEventListener("success",r),n.addEventListener("error",o)});return ae.set(e,n),e}function Rt(n){if(ge.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",o),n.removeEventListener("abort",o)},r=()=>{t(),s()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",r),n.addEventListener("error",o),n.addEventListener("abort",o)});ge.set(n,e)}let me={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ge.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return B(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function nt(n){me=n(me)}function Pt(n){return _t().includes(n)?function(...e){return n.apply(ke(this),e),B(this.request)}:function(...e){return B(n.apply(ke(this),e))}}function Lt(n){return typeof n=="function"?Pt(n):(n instanceof IDBTransaction&&Rt(n),de(n,zt())?new Proxy(n,me):n)}function B(n){if(n instanceof IDBRequest)return At(n);if(fe.has(n))return fe.get(n);const e=Lt(n);return e!==n&&(fe.set(n,e),ae.set(e,n)),e}const ke=n=>ae.get(n);function Dt(n,e,{blocked:t,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(n,e),l=B(o);return i&&o.addEventListener("upgradeneeded",c=>{i(B(o.result),c.oldVersion,c.newVersion,B(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),l.then(c=>{r&&c.addEventListener("close",()=>r()),s&&c.addEventListener("versionchange",a=>s(a.oldVersion,a.newVersion,a))}).catch(()=>{}),l}const Bt=["get","getKey","getAll","getAllKeys","count"],Mt=["put","add","delete","clear"],pe=new Map;function Me(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(pe.get(e))return pe.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=Mt.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||Bt.includes(t)))return;const r=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let a=c.store;return i&&(a=a.index(l.shift())),(await Promise.all([a[t](...l),s&&c.done]))[0]};return pe.set(e,r),r}nt(n=>({...n,get:(e,t,i)=>Me(e,t)||n.get(e,t,i),has:(e,t)=>!!Me(e,t)||n.has(e,t)}));const Ot=["continue","continuePrimaryKey","advance"],Oe={},xe=new WeakMap,it=new WeakMap,Ct={get(n,e){if(!Ot.includes(e))return n[e];let t=Oe[e];return t||(t=Oe[e]=function(...i){xe.set(this,it.get(this)[e](...i))}),t}};async function*Nt(...n){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...n)),!e)return;e=e;const t=new Proxy(e,Ct);for(it.set(t,e),ae.set(t,ke(e));e;)yield t,e=await(xe.get(t)||e.continue()),xe.delete(t)}function Ce(n,e){return e===Symbol.asyncIterator&&de(n,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&de(n,[IDBIndex,IDBObjectStore])}nt(n=>({...n,get(e,t,i){return Ce(e,t)?Nt:n.get(e,t,i)},has(e,t){return Ce(e,t)||n.has(e,t)}}));const qt="typing-notes-db",jt=1,E={NOTES:"notes",FOLDERS:"folders",SETTINGS:"settings",SYNC_META:"sync_meta"};class Ft{constructor(){this.dbPromise=null}async init(){this.dbPromise=Dt(qt,jt,{upgrade(e){if(!e.objectStoreNames.contains(E.NOTES)){const t=e.createObjectStore(E.NOTES,{keyPath:"id"});t.createIndex("folderId","folderId"),t.createIndex("updated_at","updated_at")}e.objectStoreNames.contains(E.FOLDERS)||e.createObjectStore(E.FOLDERS,{keyPath:"id"}).createIndex("parentId","parentId"),e.objectStoreNames.contains(E.SETTINGS)||e.createObjectStore(E.SETTINGS,{keyPath:"key"}),e.objectStoreNames.contains(E.SYNC_META)||e.createObjectStore(E.SYNC_META,{keyPath:"id"})}}),await this.dbPromise,console.log("Database initialized")}async get(e,t){return(await this.dbPromise).get(e,t)}async getAll(e){return(await this.dbPromise).getAll(e)}async set(e,t){const i=await(await this.dbPromise).put(e,t);return v.emit("db:update",{store:e,key:t.id||t.key,value:t}),i}async delete(e,t){const i=await(await this.dbPromise).delete(e,t);return v.emit("db:delete",{store:e,key:t}),i}async getNotesInFolder(e){return(await this.dbPromise).getAllFromIndex(E.NOTES,"folderId",e)}}const Z=new Ft,Ne={name:"Typing Notes",version:"2.0.0"};function Ie(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let O=Ie();function st(n){O=n}const rt=/[&<>"']/,Zt=new RegExp(rt.source,"g"),ot=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Ut=new RegExp(ot.source,"g"),Ht={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},qe=n=>Ht[n];function _(n,e){if(e){if(rt.test(n))return n.replace(Zt,qe)}else if(ot.test(n))return n.replace(Ut,qe);return n}const Gt=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Qt(n){return n.replace(Gt,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const Kt=/(^|[^\[])\^/g;function k(n,e){let t=typeof n=="string"?n:n.source;e=e||"";const i={replace:(s,r)=>{let o=typeof r=="string"?r:r.source;return o=o.replace(Kt,"$1"),t=t.replace(s,o),i},getRegex:()=>new RegExp(t,e)};return i}function je(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const U={exec:()=>null};function Fe(n,e){const t=n.replace(/\|/g,(r,o,l)=>{let c=!1,a=o;for(;--a>=0&&l[a]==="\\";)c=!c;return c?"|":" |"}),i=t.split(/ \|/);let s=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;s<i.length;s++)i[s]=i[s].trim().replace(/\\\|/g,"|");return i}function J(n,e,t){const i=n.length;if(i===0)return"";let s=0;for(;s<i&&n.charAt(i-s-1)===e;)s++;return n.slice(0,i-s)}function Vt(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let i=0;i<n.length;i++)if(n[i]==="\\")i++;else if(n[i]===e[0])t++;else if(n[i]===e[1]&&(t--,t<0))return i;return-1}function Ze(n,e,t,i){const s=e.href,r=e.title?_(e.title):null,o=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){i.state.inLink=!0;const l={type:"link",raw:t,href:s,title:r,text:o,tokens:i.inlineTokens(o)};return i.state.inLink=!1,l}return{type:"image",raw:t,href:s,title:r,text:_(o)}}function Wt(n,e){const t=n.match(/^(\s+)(?:```)/);if(t===null)return e;const i=t[1];return e.split(`
`).map(s=>{const r=s.match(/^\s+/);if(r===null)return s;const[o]=r;return o.length>=i.length?s.slice(i.length):s}).join(`
`)}class re{options;rules;lexer;constructor(e){this.options=e||O}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:J(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],s=Wt(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:s}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const s=J(i,"#");(this.options.pedantic||!s||/ $/.test(s))&&(i=s.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const i=J(t[0].replace(/^ *>[ \t]?/gm,""),`
`),s=this.lexer.state.top;this.lexer.state.top=!0;const r=this.lexer.blockTokens(i);return this.lexer.state.top=s,{type:"blockquote",raw:t[0],tokens:r,text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim();const s=i.length>1,r={type:"list",raw:"",ordered:s,start:s?+i.slice(0,-1):"",loose:!1,items:[]};i=s?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=s?i:"[*+-]");const o=new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`);let l="",c="",a=!1;for(;e;){let h=!1;if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;l=t[0],e=e.substring(l.length);let f=t[2].split(`
`,1)[0].replace(/^\t+/,z=>" ".repeat(3*z.length)),u=e.split(`
`,1)[0],p=0;this.options.pedantic?(p=2,c=f.trimStart()):(p=t[2].search(/[^ ]/),p=p>4?1:p,c=f.slice(p),p+=t[1].length);let d=!1;if(!f&&/^ *$/.test(u)&&(l+=u+`
`,e=e.substring(u.length+1),h=!0),!h){const z=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),I=new RegExp(`^ {0,${Math.min(3,p-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),S=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:\`\`\`|~~~)`),P=new RegExp(`^ {0,${Math.min(3,p-1)}}#`);for(;e;){const D=e.split(`
`,1)[0];if(u=D,this.options.pedantic&&(u=u.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),S.test(u)||P.test(u)||z.test(u)||I.test(e))break;if(u.search(/[^ ]/)>=p||!u.trim())c+=`
`+u.slice(p);else{if(d||f.search(/[^ ]/)>=4||S.test(f)||P.test(f)||I.test(f))break;c+=`
`+u}!d&&!u.trim()&&(d=!0),l+=D+`
`,e=e.substring(D.length+1),f=u.slice(p)}}r.loose||(a?r.loose=!0:/\n *\n *$/.test(l)&&(a=!0));let g=null,b;this.options.gfm&&(g=/^\[[ xX]\] /.exec(c),g&&(b=g[0]!=="[ ] ",c=c.replace(/^\[[ xX]\] +/,""))),r.items.push({type:"list_item",raw:l,task:!!g,checked:b,loose:!1,text:c,tokens:[]}),r.raw+=l}r.items[r.items.length-1].raw=l.trimEnd(),r.items[r.items.length-1].text=c.trimEnd(),r.raw=r.raw.trimEnd();for(let h=0;h<r.items.length;h++)if(this.lexer.state.top=!1,r.items[h].tokens=this.lexer.blockTokens(r.items[h].text,[]),!r.loose){const f=r.items[h].tokens.filter(p=>p.type==="space"),u=f.length>0&&f.some(p=>/\n.*\n/.test(p.raw));r.loose=u}if(r.loose)for(let h=0;h<r.items.length;h++)r.items[h].loose=!0;return r}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const i=t[1].toLowerCase().replace(/\s+/g," "),s=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:s,title:r}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const i=Fe(t[1]),s=t[2].replace(/^\||\| *$/g,"").split("|"),r=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===s.length){for(const l of s)/^ *-+: *$/.test(l)?o.align.push("right"):/^ *:-+: *$/.test(l)?o.align.push("center"):/^ *:-+ *$/.test(l)?o.align.push("left"):o.align.push(null);for(const l of i)o.header.push({text:l,tokens:this.lexer.inline(l)});for(const l of r)o.rows.push(Fe(l,o.header.length).map(c=>({text:c,tokens:this.lexer.inline(c)})));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:_(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const o=J(i.slice(0,-1),"\\");if((i.length-o.length)%2===0)return}else{const o=Vt(t[2],"()");if(o>-1){const c=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,c).trim(),t[3]=""}}let s=t[2],r="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);o&&(s=o[1],r=o[3])}else r=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(this.options.pedantic&&!/>$/.test(i)?s=s.slice(1):s=s.slice(1,-1)),Ze(t,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const s=(i[2]||i[1]).replace(/\s+/g," "),r=t[s.toLowerCase()];if(!r){const o=i[0].charAt(0);return{type:"text",raw:o,text:o}}return Ze(i,r,i[0],this.lexer)}}emStrong(e,t,i=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(!s||s[3]&&i.match(/[\p{L}\p{N}]/u))return;if(!(s[1]||s[2]||"")||!i||this.rules.inline.punctuation.exec(i)){const o=[...s[0]].length-1;let l,c,a=o,h=0;const f=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(f.lastIndex=0,t=t.slice(-1*e.length+o);(s=f.exec(t))!=null;){if(l=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!l)continue;if(c=[...l].length,s[3]||s[4]){a+=c;continue}else if((s[5]||s[6])&&o%3&&!((o+c)%3)){h+=c;continue}if(a-=c,a>0)continue;c=Math.min(c,c+a+h);const u=[...s[0]][0].length,p=e.slice(0,o+s.index+u+c);if(Math.min(o,c)%2){const g=p.slice(1,-1);return{type:"em",raw:p,text:g,tokens:this.lexer.inlineTokens(g)}}const d=p.slice(2,-2);return{type:"strong",raw:p,text:d,tokens:this.lexer.inlineTokens(d)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const s=/[^ ]/.test(i),r=/^ /.test(i)&&/ $/.test(i);return s&&r&&(i=i.substring(1,i.length-1)),i=_(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let i,s;return t[2]==="@"?(i=_(t[1]),s="mailto:"+i):(i=_(t[1]),s=i),{type:"link",raw:t[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let i,s;if(t[2]==="@")i=_(t[0]),s="mailto:"+i;else{let r;do r=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(r!==t[0]);i=_(t[0]),t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let i;return this.lexer.state.inRawBlock?i=t[0]:i=_(t[0]),{type:"text",raw:t[0],text:i}}}}const Jt=/^(?: *(?:\n|$))+/,Xt=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,Yt=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Q=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,en=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,lt=/(?:[*+-]|\d{1,9}[.)])/,ct=k(/^(?!bull )((?:.|\n(?!\s*?\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,lt).getRegex(),$e=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,tn=/^[^\n]+/,Ee=/(?!\s*\])(?:\\.|[^\[\]\\])+/,nn=k(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",Ee).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),sn=k(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,lt).getRegex(),he="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ze=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,rn=k("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",ze).replace("tag",he).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),at=k($e).replace("hr",Q).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",he).getRegex(),on=k(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",at).getRegex(),_e={blockquote:on,code:Xt,def:nn,fences:Yt,heading:en,hr:Q,html:rn,lheading:ct,list:sn,newline:Jt,paragraph:at,table:U,text:tn},Ue=k("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Q).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",he).getRegex(),ln={..._e,table:Ue,paragraph:k($e).replace("hr",Q).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ue).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",he).getRegex()},cn={..._e,html:k(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ze).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:U,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:k($e).replace("hr",Q).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ct).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},ht=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,an=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ut=/^( {2,}|\\)\n(?!\s*$)/,hn=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,K="\\p{P}$+<=>`^|~",un=k(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,K).getRegex(),fn=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,pn=k(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,K).getRegex(),dn=k("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,K).getRegex(),gn=k("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,K).getRegex(),mn=k(/\\([punct])/,"gu").replace(/punct/g,K).getRegex(),kn=k(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),xn=k(ze).replace("(?:-->|$)","-->").getRegex(),wn=k("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",xn).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),oe=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,yn=k(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",oe).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ft=k(/^!?\[(label)\]\[(ref)\]/).replace("label",oe).replace("ref",Ee).getRegex(),pt=k(/^!?\[(ref)\](?:\[\])?/).replace("ref",Ee).getRegex(),bn=k("reflink|nolink(?!\\()","g").replace("reflink",ft).replace("nolink",pt).getRegex(),Ae={_backpedal:U,anyPunctuation:mn,autolink:kn,blockSkip:fn,br:ut,code:an,del:U,emStrongLDelim:pn,emStrongRDelimAst:dn,emStrongRDelimUnd:gn,escape:ht,link:yn,nolink:pt,punctuation:un,reflink:ft,reflinkSearch:bn,tag:wn,text:hn,url:U},vn={...Ae,link:k(/^!?\[(label)\]\((.*?)\)/).replace("label",oe).getRegex(),reflink:k(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",oe).getRegex()},we={...Ae,escape:k(ht).replace("])","~|])").getRegex(),url:k(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Sn={...we,br:k(ut).replace("{2,}","*").getRegex(),text:k(we.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},X={normal:_e,gfm:ln,pedantic:cn},q={normal:Ae,gfm:we,breaks:Sn,pedantic:vn};class A{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||O,this.options.tokenizer=this.options.tokenizer||new re,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:X.normal,inline:q.normal};this.options.pedantic?(t.block=X.pedantic,t.inline=q.pedantic):this.options.gfm&&(t.block=X.gfm,this.options.breaks?t.inline=q.breaks:t.inline=q.gfm),this.tokenizer.rules=t}static get rules(){return{block:X,inline:q}}static lex(e,t){return new A(t).lex(e)}static lexInline(e,t){return new A(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const i=this.inlineQueue[t];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(l,c,a)=>c+"    ".repeat(a.length));let i,s,r,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(l=>(i=l.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length),i.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length),s=t[t.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+i.raw,s.text+=`
`+i.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length),s=t[t.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+i.raw,s.text+=`
`+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(r=e,this.options.extensions&&this.options.extensions.startBlock){let l=1/0;const c=e.slice(1);let a;this.options.extensions.startBlock.forEach(h=>{a=h.call({lexer:this},c),typeof a=="number"&&a>=0&&(l=Math.min(l,a))}),l<1/0&&l>=0&&(r=e.substring(0,l+1))}if(this.state.top&&(i=this.tokenizer.paragraph(r))){s=t[t.length-1],o&&s.type==="paragraph"?(s.raw+=`
`+i.raw,s.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(i),o=r.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length),s=t[t.length-1],s&&s.type==="text"?(s.raw+=`
`+i.raw,s.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(i);continue}if(e){const l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let i,s,r,o=e,l,c,a;if(this.tokens.links){const h=Object.keys(this.tokens.links);if(h.length>0)for(;(l=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)h.includes(l[0].slice(l[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,l.index)+"["+"a".repeat(l[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(l=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,l.index)+"["+"a".repeat(l[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(l=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,l.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(c||(a=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(h=>(i=h.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),s=t[t.length-1],s&&i.type==="text"&&s.type==="text"?(s.raw+=i.raw,s.text+=i.text):t.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),s=t[t.length-1],s&&i.type==="text"&&s.type==="text"?(s.raw+=i.raw,s.text+=i.text):t.push(i);continue}if(i=this.tokenizer.emStrong(e,o,a)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.autolink(e)){e=e.substring(i.raw.length),t.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e))){e=e.substring(i.raw.length),t.push(i);continue}if(r=e,this.options.extensions&&this.options.extensions.startInline){let h=1/0;const f=e.slice(1);let u;this.options.extensions.startInline.forEach(p=>{u=p.call({lexer:this},f),typeof u=="number"&&u>=0&&(h=Math.min(h,u))}),h<1/0&&h>=0&&(r=e.substring(0,h+1))}if(i=this.tokenizer.inlineText(r)){e=e.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(a=i.raw.slice(-1)),c=!0,s=t[t.length-1],s&&s.type==="text"?(s.raw+=i.raw,s.text+=i.text):t.push(i);continue}if(e){const h="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return t}}class le{options;constructor(e){this.options=e||O}code(e,t,i){const s=(t||"").match(/^\S*/)?.[0];return e=e.replace(/\n$/,"")+`
`,s?'<pre><code class="language-'+_(s)+'">'+(i?e:_(e,!0))+`</code></pre>
`:"<pre><code>"+(i?e:_(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,t){return e}heading(e,t,i){return`<h${t}>${e}</h${t}>
`}hr(){return`<hr>
`}list(e,t,i){const s=t?"ol":"ul",r=t&&i!==1?' start="'+i+'"':"";return"<"+s+r+`>
`+e+"</"+s+`>
`}listitem(e,t,i){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const i=t.header?"th":"td";return(t.align?`<${i} align="${t.align}">`:`<${i}>`)+e+`</${i}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,i){const s=je(e);if(s===null)return i;e=s;let r='<a href="'+e+'"';return t&&(r+=' title="'+t+'"'),r+=">"+i+"</a>",r}image(e,t,i){const s=je(e);if(s===null)return i;e=s;let r=`<img src="${e}" alt="${i}"`;return t&&(r+=` title="${t}"`),r+=">",r}text(e){return e}}class Re{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,i){return""+i}image(e,t,i){return""+i}br(){return""}}class R{options;renderer;textRenderer;constructor(e){this.options=e||O,this.options.renderer=this.options.renderer||new le,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Re}static parse(e,t){return new R(t).parse(e)}static parseInline(e,t){return new R(t).parseInline(e)}parse(e,t=!0){let i="";for(let s=0;s<e.length;s++){const r=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]){const o=r,l=this.options.extensions.renderers[o.type].call({parser:this},o);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)){i+=l||"";continue}}switch(r.type){case"space":continue;case"hr":{i+=this.renderer.hr();continue}case"heading":{const o=r;i+=this.renderer.heading(this.parseInline(o.tokens),o.depth,Qt(this.parseInline(o.tokens,this.textRenderer)));continue}case"code":{const o=r;i+=this.renderer.code(o.text,o.lang,!!o.escaped);continue}case"table":{const o=r;let l="",c="";for(let h=0;h<o.header.length;h++)c+=this.renderer.tablecell(this.parseInline(o.header[h].tokens),{header:!0,align:o.align[h]});l+=this.renderer.tablerow(c);let a="";for(let h=0;h<o.rows.length;h++){const f=o.rows[h];c="";for(let u=0;u<f.length;u++)c+=this.renderer.tablecell(this.parseInline(f[u].tokens),{header:!1,align:o.align[u]});a+=this.renderer.tablerow(c)}i+=this.renderer.table(l,a);continue}case"blockquote":{const o=r,l=this.parse(o.tokens);i+=this.renderer.blockquote(l);continue}case"list":{const o=r,l=o.ordered,c=o.start,a=o.loose;let h="";for(let f=0;f<o.items.length;f++){const u=o.items[f],p=u.checked,d=u.task;let g="";if(u.task){const b=this.renderer.checkbox(!!p);a?u.tokens.length>0&&u.tokens[0].type==="paragraph"?(u.tokens[0].text=b+" "+u.tokens[0].text,u.tokens[0].tokens&&u.tokens[0].tokens.length>0&&u.tokens[0].tokens[0].type==="text"&&(u.tokens[0].tokens[0].text=b+" "+u.tokens[0].tokens[0].text)):u.tokens.unshift({type:"text",text:b+" "}):g+=b+" "}g+=this.parse(u.tokens,a),h+=this.renderer.listitem(g,d,!!p)}i+=this.renderer.list(h,l,c);continue}case"html":{const o=r;i+=this.renderer.html(o.text,o.block);continue}case"paragraph":{const o=r;i+=this.renderer.paragraph(this.parseInline(o.tokens));continue}case"text":{let o=r,l=o.tokens?this.parseInline(o.tokens):o.text;for(;s+1<e.length&&e[s+1].type==="text";)o=e[++s],l+=`
`+(o.tokens?this.parseInline(o.tokens):o.text);i+=t?this.renderer.paragraph(l):l;continue}default:{const o='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return i}parseInline(e,t){t=t||this.renderer;let i="";for(let s=0;s<e.length;s++){const r=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]){const o=this.options.extensions.renderers[r.type].call({parser:this},r);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)){i+=o||"";continue}}switch(r.type){case"escape":{const o=r;i+=t.text(o.text);break}case"html":{const o=r;i+=t.html(o.text);break}case"link":{const o=r;i+=t.link(o.href,o.title,this.parseInline(o.tokens,t));break}case"image":{const o=r;i+=t.image(o.href,o.title,o.text);break}case"strong":{const o=r;i+=t.strong(this.parseInline(o.tokens,t));break}case"em":{const o=r;i+=t.em(this.parseInline(o.tokens,t));break}case"codespan":{const o=r;i+=t.codespan(o.text);break}case"br":{i+=t.br();break}case"del":{const o=r;i+=t.del(this.parseInline(o.tokens,t));break}case"text":{const o=r;i+=t.text(o.text);break}default:{const o='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return i}}class ne{options;constructor(e){this.options=e||O}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}class Tn{defaults=Ie();options=this.setOptions;parse=this.#e(A.lex,R.parse);parseInline=this.#e(A.lexInline,R.parseInline);Parser=R;Renderer=le;TextRenderer=Re;Lexer=A;Tokenizer=re;Hooks=ne;constructor(...e){this.use(...e)}walkTokens(e,t){let i=[];for(const s of e)switch(i=i.concat(t.call(this,s)),s.type){case"table":{const r=s;for(const o of r.header)i=i.concat(this.walkTokens(o.tokens,t));for(const o of r.rows)for(const l of o)i=i.concat(this.walkTokens(l.tokens,t));break}case"list":{const r=s;i=i.concat(this.walkTokens(r.items,t));break}default:{const r=s;this.defaults.extensions?.childTokens?.[r.type]?this.defaults.extensions.childTokens[r.type].forEach(o=>{const l=r[o].flat(1/0);i=i.concat(this.walkTokens(l,t))}):r.tokens&&(i=i.concat(this.walkTokens(r.tokens,t)))}}return i}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const s={...i};if(s.async=this.defaults.async||s.async||!1,i.extensions&&(i.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){const o=t.renderers[r.name];o?t.renderers[r.name]=function(...l){let c=r.renderer.apply(this,l);return c===!1&&(c=o.apply(this,l)),c}:t.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=t[r.level];o?o.unshift(r.tokenizer):t[r.level]=[r.tokenizer],r.start&&(r.level==="block"?t.startBlock?t.startBlock.push(r.start):t.startBlock=[r.start]:r.level==="inline"&&(t.startInline?t.startInline.push(r.start):t.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(t.childTokens[r.name]=r.childTokens)}),s.extensions=t),i.renderer){const r=this.defaults.renderer||new le(this.defaults);for(const o in i.renderer){if(!(o in r))throw new Error(`renderer '${o}' does not exist`);if(o==="options")continue;const l=o,c=i.renderer[l],a=r[l];r[l]=(...h)=>{let f=c.apply(r,h);return f===!1&&(f=a.apply(r,h)),f||""}}s.renderer=r}if(i.tokenizer){const r=this.defaults.tokenizer||new re(this.defaults);for(const o in i.tokenizer){if(!(o in r))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const l=o,c=i.tokenizer[l],a=r[l];r[l]=(...h)=>{let f=c.apply(r,h);return f===!1&&(f=a.apply(r,h)),f}}s.tokenizer=r}if(i.hooks){const r=this.defaults.hooks||new ne;for(const o in i.hooks){if(!(o in r))throw new Error(`hook '${o}' does not exist`);if(o==="options")continue;const l=o,c=i.hooks[l],a=r[l];ne.passThroughHooks.has(o)?r[l]=h=>{if(this.defaults.async)return Promise.resolve(c.call(r,h)).then(u=>a.call(r,u));const f=c.call(r,h);return a.call(r,f)}:r[l]=(...h)=>{let f=c.apply(r,h);return f===!1&&(f=a.apply(r,h)),f}}s.hooks=r}if(i.walkTokens){const r=this.defaults.walkTokens,o=i.walkTokens;s.walkTokens=function(l){let c=[];return c.push(o.call(this,l)),r&&(c=c.concat(r.call(this,l))),c}}this.defaults={...this.defaults,...s}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return A.lex(e,t??this.defaults)}parser(e,t){return R.parse(e,t??this.defaults)}#e(e,t){return(i,s)=>{const r={...s},o={...this.defaults,...r};this.defaults.async===!0&&r.async===!1&&(o.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),o.async=!0);const l=this.#t(!!o.silent,!!o.async);if(typeof i>"u"||i===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof i!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(i):i).then(c=>e(c,o)).then(c=>o.hooks?o.hooks.processAllTokens(c):c).then(c=>o.walkTokens?Promise.all(this.walkTokens(c,o.walkTokens)).then(()=>c):c).then(c=>t(c,o)).then(c=>o.hooks?o.hooks.postprocess(c):c).catch(l);try{o.hooks&&(i=o.hooks.preprocess(i));let c=e(i,o);o.hooks&&(c=o.hooks.processAllTokens(c)),o.walkTokens&&this.walkTokens(c,o.walkTokens);let a=t(c,o);return o.hooks&&(a=o.hooks.postprocess(a)),a}catch(c){return l(c)}}}#t(e,t){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const s="<p>An error occurred:</p><pre>"+_(i.message+"",!0)+"</pre>";return t?Promise.resolve(s):s}if(t)return Promise.reject(i);throw i}}}const M=new Tn;function m(n,e){return M.parse(n,e)}m.options=m.setOptions=function(n){return M.setOptions(n),m.defaults=M.defaults,st(m.defaults),m};m.getDefaults=Ie;m.defaults=O;m.use=function(...n){return M.use(...n),m.defaults=M.defaults,st(m.defaults),m};m.walkTokens=function(n,e){return M.walkTokens(n,e)};m.parseInline=M.parseInline;m.Parser=R;m.parser=R.parse;m.Renderer=le;m.TextRenderer=Re;m.Lexer=A;m.lexer=A.lex;m.Tokenizer=re;m.Hooks=ne;m.parse=m;m.options;m.setOptions;m.use;m.walkTokens;m.parseInline;R.parse;A.lex;let In=class{constructor(){this.name="editor",this.container=null,this.currentNote=null}init(){console.log("Editor Module Initialized"),v.on("file:open",e=>this.openFile(e)),v.on("note:create",e=>this.openFile(e))}mount(e){this.container=document.getElementById(e),this.render()}render(){this.container&&(this.container.innerHTML=`
            <div class="editor-wrapper">
                <input type="text" id="note-title" class="note-title" placeholder="Untitled Note" />
                <div class="toolbar">
                    <button class="btn-preview">üëÅÔ∏è Preview</button>
                    <button class="btn-save">üíæ Save</button>
                </div>
                <div class="editor-split">
                    <textarea id="editor-raw" class="editor-content" placeholder="Type markdown here..."></textarea>
                    <div id="editor-preview" class="editor-content" style="display:none;"></div>
                </div>
            </div>
        `,this.bindEvents())}bindEvents(){const e=this.container.querySelector("#note-title"),t=this.container.querySelector("#editor-raw"),i=this.container.querySelector(".btn-preview"),s=this.container.querySelector(".btn-save");t.addEventListener("input",()=>{this.currentNote&&(this.currentNote.content=t.value)}),e.addEventListener("input",()=>{this.currentNote&&(this.currentNote.title=e.value)}),i.addEventListener("click",()=>{const r=this.container.querySelector("#editor-preview");r.style.display!=="none"?(r.style.display="none",t.style.display="block"):(r.innerHTML=m.parse(t.value),r.style.display="block",t.style.display="none")}),s.addEventListener("click",()=>{this.currentNote&&v.emit("note:save",this.currentNote)})}openFile(e){if(!this.container)return;this.currentNote=e;const t=this.container.querySelector("#note-title"),i=this.container.querySelector("#editor-raw"),s=this.container.querySelector("#editor-preview");t.value=e.title,i.value=e.content,s.style.display="none",i.style.display="block",console.log("Editor opened note:",e.id)}};const ye=new In;let Y;const $n=new Uint8Array(16);function En(){if(!Y&&(Y=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Y))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Y($n)}const T=[];for(let n=0;n<256;++n)T.push((n+256).toString(16).slice(1));function zn(n,e=0){return T[n[e+0]]+T[n[e+1]]+T[n[e+2]]+T[n[e+3]]+"-"+T[n[e+4]]+T[n[e+5]]+"-"+T[n[e+6]]+T[n[e+7]]+"-"+T[n[e+8]]+T[n[e+9]]+"-"+T[n[e+10]]+T[n[e+11]]+T[n[e+12]]+T[n[e+13]]+T[n[e+14]]+T[n[e+15]]}const _n=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),He={randomUUID:_n};function Ge(n,e,t){if(He.randomUUID&&!n)return He.randomUUID();n=n||{};const i=n.random||(n.rng||En)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,zn(i)}const An={createNote(n="Untitled",e="",t=null){const i=new Date().toISOString();return{id:Ge(),title:n,content:e,folderId:t,tags:[],is_pinned:!1,is_favorite:!1,created_at:i,updated_at:i}},createFolder(n,e=null){return{id:Ge(),name:n,parentId:e,color:"#007aff",icon:"folder",created_at:new Date().toISOString()}}};class Rn{constructor(){this.name="filesystem"}init(){console.log("FileSystem Module Initialized"),v.on("note:create",e=>this.createNote(e)),v.on("note:save",e=>this.saveNote(e)),v.on("folder:create",e=>this.createFolder(e)),this.loadNotes()}async createNote({title:e,content:t}){const i=An.createNote(e,t);await Z.set(E.NOTES,i),console.log("Note Created:",i),await this.loadNotes(),v.emit("file:open",i)}async saveNote(e){e.updated_at=new Date().toISOString(),await Z.set(E.NOTES,e),console.log("Note Saved:",e),await this.loadNotes()}async loadNotes(){const e=await Z.getAll(E.NOTES);this.notes=e||[],this.render()}mount(e){this.container=document.getElementById(e),this.render()}render(){if(this.container){if(this.notes.length===0){this.container.innerHTML='<div class="empty-list">No notes yet</div>';return}this.container.innerHTML=`
            <ul class="note-list">
                ${this.notes.map(e=>`
                    <li class="note-item" data-id="${e.id}">
                        <div class="note-title">${e.title}</div>
                        <div class="note-meta">${new Date(e.updated_at).toLocaleDateString()}</div>
                    </li>
                `).join("")}
            </ul>
        `,this.container.querySelectorAll(".note-item").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.id,i=this.notes.find(s=>s.id===t);i&&v.emit("file:open",i)})})}}}const be=new Rn;var w;function ie(n){return typeof n<"u"?n:!0}function Qe(n){const e=Array(n);for(let t=0;t<n;t++)e[t]=x();return e}function x(){return Object.create(null)}function Pn(n,e){return e.length-n.length}function $(n){return typeof n=="string"}function L(n){return typeof n=="object"}function Pe(n){return typeof n=="function"}function dt(n,e){var t=Ln;if(n&&(e&&(n=se(n,e)),this.H&&(n=se(n,this.H)),this.J&&1<n.length&&(n=se(n,this.J)),t||t==="")){if(e=n.split(t),this.filter){n=this.filter,t=e.length;const i=[];for(let s=0,r=0;s<t;s++){const o=e[s];o&&!n[o]&&(i[r++]=o)}n=i}else n=e;return n}return n}const Ln=/[\p{Z}\p{S}\p{P}\p{C}]+/u,Dn=/[\u0300-\u036f]/g;function Ke(n,e){const t=Object.keys(n),i=t.length,s=[];let r="",o=0;for(let l=0,c,a;l<i;l++)c=t[l],(a=n[c])?(s[o++]=y(e?"(?!\\b)"+c+"(\\b|_)":c),s[o++]=a):r+=(r?"|":"")+c;return r&&(s[o++]=y(e?"(?!\\b)("+r+")(\\b|_)":"("+r+")"),s[o]=""),s}function se(n,e){for(let t=0,i=e.length;t<i&&(n=n.replace(e[t],e[t+1]),n);t+=2);return n}function y(n){return new RegExp(n,"g")}function gt(n){let e="",t="";for(let i=0,s=n.length,r;i<s;i++)(r=n[i])!==t&&(e+=t=r);return e}var Bn={encode:mt,F:!1,G:""};function mt(n){return dt.call(this,(""+n).toLowerCase(),!1)}const Mn={},N={};function kt(n){j(n,"add"),j(n,"append"),j(n,"search"),j(n,"update"),j(n,"remove")}function j(n,e){n[e+"Async"]=function(){const t=this,i=arguments;var s=i[i.length-1];let r;return Pe(s)&&(r=s,delete i[i.length-1]),s=new Promise(function(o){setTimeout(function(){t.async=!0;const l=t[e].apply(t,i);t.async=!1,o(l)})}),r?(s.then(r),this):s}}function xt(n,e,t,i){const s=n.length;let r=[],o,l,c=0;i&&(i=[]);for(let a=s-1;0<=a;a--){const h=n[a],f=h.length,u=x();let p=!o;for(let d=0;d<f;d++){const g=h[d],b=g.length;if(b)for(let z=0,I,S;z<b;z++)if(S=g[z],o){if(o[S]){if(!a){if(t)t--;else if(r[c++]=S,c===e)return r}(a||i)&&(u[S]=1),p=!0}if(i&&(I=(l[S]||0)+1,l[S]=I,I<s)){const P=i[I-2]||(i[I-2]=[]);P[P.length]=S}}else u[S]=1}if(i)o||(l=u);else if(!p)return[];o=u}if(i)for(let a=i.length-1,h,f;0<=a;a--){h=i[a],f=h.length;for(let u=0,p;u<f;u++)if(p=h[u],!o[p]){if(t)t--;else if(r[c++]=p,c===e)return r;o[p]=1}}return r}function On(n,e){const t=x(),i=x(),s=[];for(let r=0;r<n.length;r++)t[n[r]]=1;for(let r=0,o;r<e.length;r++){o=e[r];for(let l=0,c;l<o.length;l++)c=o[l],t[c]&&!i[c]&&(i[c]=1,s[s.length]=c)}return s}function ue(n){this.l=n!==!0&&n,this.cache=x(),this.h=[]}function wt(n,e,t){L(n)&&(n=n.query);let i=this.cache.get(n);return i||(i=this.search(n,e,t),this.cache.set(n,i)),i}ue.prototype.set=function(n,e){if(!this.cache[n]){var t=this.h.length;for(t===this.l?delete this.cache[this.h[t-1]]:t++,--t;0<t;t--)this.h[t]=this.h[t-1];this.h[0]=n}this.cache[n]=e};ue.prototype.get=function(n){const e=this.cache[n];if(this.l&&e&&(n=this.h.indexOf(n))){const t=this.h[n-1];this.h[n-1]=this.h[n],this.h[n]=t}return e};const Cn={memory:{charset:"latin:extra",D:3,B:4,m:!1},performance:{D:3,B:3,s:!1,context:{depth:2,D:1}},match:{charset:"latin:extra",G:"reverse"},score:{charset:"latin:advanced",D:20,B:3,context:{depth:3,D:9}},default:{}};function yt(n,e,t,i,s,r,o,l){setTimeout(function(){const c=n(t?t+"."+i:i,JSON.stringify(o));c&&c.then?c.then(function(){e.export(n,e,t,s,r+1,l)}):e.export(n,e,t,s,r+1,l)})}function C(n,e){if(!(this instanceof C))return new C(n);var t;if(n){$(n)?n=Cn[n]:(t=n.preset)&&(n=Object.assign({},t[t],n)),t=n.charset;var i=n.lang;$(t)&&(t.indexOf(":")===-1&&(t+=":default"),t=N[t]),$(i)&&(i=Mn[i])}else n={};let s,r,o=n.context||{};if(this.encode=n.encode||t&&t.encode||mt,this.register=e||x(),this.D=s=n.resolution||9,this.G=e=t&&t.G||n.tokenize||"strict",this.depth=e==="strict"&&o.depth,this.l=ie(o.bidirectional),this.s=r=ie(n.optimize),this.m=ie(n.fastupdate),this.B=n.minlength||1,this.C=n.boost,this.map=r?Qe(s):x(),this.A=s=o.resolution||1,this.h=r?Qe(s):x(),this.F=t&&t.F||n.rtl,this.H=(e=n.matcher||i&&i.H)&&Ke(e,!1),this.J=(e=n.stemmer||i&&i.J)&&Ke(e,!0),t=e=n.filter||i&&i.filter){t=e,i=x();for(let l=0,c=t.length;l<c;l++)i[t[l]]=1;t=i}this.filter=t,this.cache=(e=n.cache)&&new ue(e)}w=C.prototype;w.append=function(n,e){return this.add(n,e,!0)};w.add=function(n,e,t,i){if(e&&(n||n===0)){if(!i&&!t&&this.register[n])return this.update(n,e);if(e=this.encode(e),i=e.length){const a=x(),h=x(),f=this.depth,u=this.D;for(let p=0;p<i;p++){let d=e[this.F?i-1-p:p];var s=d.length;if(d&&s>=this.B&&(f||!h[d])){var r=ee(u,i,p),o="";switch(this.G){case"full":if(2<s){for(r=0;r<s;r++)for(var l=s;l>r;l--)if(l-r>=this.B){var c=ee(u,i,p,s,r);o=d.substring(r,l),F(this,h,o,c,n,t)}break}case"reverse":if(1<s){for(l=s-1;0<l;l--)o=d[l]+o,o.length>=this.B&&F(this,h,o,ee(u,i,p,s,l),n,t);o=""}case"forward":if(1<s){for(l=0;l<s;l++)o+=d[l],o.length>=this.B&&F(this,h,o,r,n,t);break}default:if(this.C&&(r=Math.min(r/this.C(e,d,p)|0,u-1)),F(this,h,d,r,n,t),f&&1<i&&p<i-1){for(s=x(),o=this.A,r=d,l=Math.min(f+1,i-p),s[r]=1,c=1;c<l;c++)if((d=e[this.F?i-1-p-c:p+c])&&d.length>=this.B&&!s[d]){s[d]=1;const g=this.l&&d>r;F(this,a,g?r:d,ee(o+(i/2>o?0:1),i,p,l-1,c-1),n,t,g?d:r)}}}}}this.m||(this.register[n]=1)}}return this};function ee(n,e,t,i,s){return t&&1<n?e+(i||0)<=n?t+(s||0):(n-1)/(e+(i||0))*(t+(s||0))+1|0:0}function F(n,e,t,i,s,r,o){let l=o?n.h:n.map;(!e[t]||o&&!e[t][o])&&(n.s&&(l=l[i]),o?(e=e[t]||(e[t]=x()),e[o]=1,l=l[o]||(l[o]=x())):e[t]=1,l=l[t]||(l[t]=[]),n.s||(l=l[i]||(l[i]=[])),r&&l.includes(s)||(l[l.length]=s,n.m&&(n=n.register[s]||(n.register[s]=[]),n[n.length]=l)))}w.search=function(n,e,t){t||(!e&&L(n)?(t=n,n=t.query):L(e)&&(t=e));let i=[],s,r,o=0;if(t){n=t.query||n,e=t.limit,o=t.offset||0;var l=t.context;r=t.suggest}if(n&&(n=this.encode(""+n),s=n.length,1<s)){t=x();var c=[];for(let h=0,f=0,u;h<s;h++)if((u=n[h])&&u.length>=this.B&&!t[u])if(this.s||r||this.map[u])c[f++]=u,t[u]=1;else return i;n=c,s=n.length}if(!s)return i;e||(e=100),l=this.depth&&1<s&&l!==!1,t=0;let a;l?(a=n[0],t=1):1<s&&n.sort(Pn);for(let h,f;t<s;t++){if(f=n[t],l?(h=Ve(this,i,r,e,o,s===2,f,a),r&&h===!1&&i.length||(a=f)):h=Ve(this,i,r,e,o,s===1,f),h)return h;if(r&&t===s-1){if(c=i.length,!c){if(l){l=0,t=-1;continue}return i}if(c===1)return bt(i[0],e,o)}}return xt(i,e,o,r)};function Ve(n,e,t,i,s,r,o,l){let c=[],a=l?n.h:n.map;if(n.s||(a=We(a,o,l,n.l)),a){let h=0;const f=Math.min(a.length,l?n.A:n.D);for(let u=0,p=0,d,g;u<f&&!((d=a[u])&&(n.s&&(d=We(d,o,l,n.l)),s&&d&&r&&(g=d.length,g<=s?(s-=g,d=null):(d=d.slice(s),s=0)),d&&(c[h++]=d,r&&(p+=d.length,p>=i))));u++);if(h){if(r)return bt(c,i,0);e[e.length]=c;return}}return!t&&c}function bt(n,e,t){return n=n.length===1?n[0]:[].concat.apply([],n),t||n.length>e?n.slice(t,t+e):n}function We(n,e,t,i){return t?(i=i&&e>t,n=(n=n[i?e:t])&&n[i?t:e]):n=n[e],n}w.contain=function(n){return!!this.register[n]};w.update=function(n,e){return this.remove(n).add(n,e)};w.remove=function(n,e){const t=this.register[n];if(t){if(this.m)for(let i=0,s;i<t.length;i++)s=t[i],s.splice(s.indexOf(n),1);else ce(this.map,n,this.D,this.s),this.depth&&ce(this.h,n,this.A,this.s);if(e||delete this.register[n],this.cache){e=this.cache;for(let i=0,s,r;i<e.h.length;i++)r=e.h[i],s=e.cache[r],s.includes(n)&&(e.h.splice(i--,1),delete e.cache[r])}}return this};function ce(n,e,t,i,s){let r=0;if(n.constructor===Array)if(s)e=n.indexOf(e),e!==-1?1<n.length&&(n.splice(e,1),r++):r++;else{s=Math.min(n.length,t);for(let o=0,l;o<s;o++)(l=n[o])&&(r=ce(l,e,t,i,s),i||r||delete n[o])}else for(let o in n)(r=ce(n[o],e,t,i,s))||delete n[o];return r}w.searchCache=wt;w.export=function(n,e,t,i,s,r){let o=!0;typeof r>"u"&&(o=new Promise(a=>{r=a}));let l,c;switch(s||(s=0)){case 0:if(l="reg",this.m){c=x();for(let a in this.register)c[a]=1}else c=this.register;break;case 1:l="cfg",c={doc:0,opt:this.s?1:0};break;case 2:l="map",c=this.map;break;case 3:l="ctx",c=this.h;break;default:typeof t>"u"&&r&&r();return}return yt(n,e||this,t,l,i,s,c,r),o};w.import=function(n,e){if(e)switch($(e)&&(e=JSON.parse(e)),n){case"cfg":this.s=!!e.opt;break;case"reg":this.m=!1,this.register=e;break;case"map":this.map=e;break;case"ctx":this.h=e}};kt(C.prototype);function Nn(n){n=n.data;var e=self._index;const t=n.args;var i=n.task;switch(i){case"init":i=n.options||{},n=n.factory,e=i.encode,i.cache=!1,e&&e.indexOf("function")===0&&(i.encode=Function("return "+e)()),n?(Function("return "+n)()(self),self._index=new self.FlexSearch.Index(i),delete self.FlexSearch):self._index=new C(i);break;default:n=n.id,e=e[i].apply(e,t),postMessage(i==="search"?{id:n,msg:e}:{id:n})}}let Je=0;function H(n){if(!(this instanceof H))return new H(n);var e;n?Pe(e=n.encode)&&(n.encode=e.toString()):n={},(e=(self||window)._factory)&&(e=e.toString());const t=typeof window>"u"&&self.exports,i=this;this.o=qn(e,t,n.worker),this.h=x(),this.o&&(t?this.o.on("message",function(s){i.h[s.id](s.msg),delete i.h[s.id]}):this.o.onmessage=function(s){s=s.data,i.h[s.id](s.msg),delete i.h[s.id]},this.o.postMessage({task:"init",factory:e,options:n}))}V("add");V("append");V("search");V("update");V("remove");function V(n){H.prototype[n]=H.prototype[n+"Async"]=function(){const e=this,t=[].slice.call(arguments);var i=t[t.length-1];let s;return Pe(i)&&(s=i,t.splice(t.length-1,1)),i=new Promise(function(r){setTimeout(function(){e.h[++Je]=r,e.o.postMessage({task:n,id:Je,args:t})})}),s?(i.then(s),this):i}}function qn(n,e,t){let i;try{i=e?new(require("worker_threads")).Worker(__dirname+"/node/node.js"):n?new Worker(URL.createObjectURL(new Blob(["onmessage="+Nn.toString()],{type:"text/javascript"}))):new Worker($(t)?t:"worker/worker.js",{type:"module"})}catch{}return i}function G(n){if(!(this instanceof G))return new G(n);var e=n.document||n.doc||n,t;this.K=[],this.h=[],this.A=[],this.register=x(),this.key=(t=e.key||e.id)&&te(t,this.A)||"id",this.m=ie(n.fastupdate),this.C=(t=e.store)&&t!==!0&&[],this.store=t&&x(),this.I=(t=e.tag)&&te(t,this.A),this.l=t&&x(),this.cache=(t=n.cache)&&new ue(t),n.cache=!1,this.o=n.worker,this.async=!1,t=x();let i=e.index||e.field||e;$(i)&&(i=[i]);for(let s=0,r,o;s<i.length;s++)r=i[s],$(r)||(o=r,r=r.field),o=L(o)?Object.assign({},n,o):n,this.o&&(t[r]=new H(o),t[r].o||(this.o=!1)),this.o||(t[r]=new C(o,this.register)),this.K[s]=te(r,this.A),this.h[s]=r;if(this.C)for(n=e.store,$(n)&&(n=[n]),e=0;e<n.length;e++)this.C[e]=te(n[e],this.A);this.index=t}function te(n,e){const t=n.split(":");let i=0;for(let s=0;s<t.length;s++)n=t[s],0<=n.indexOf("[]")&&(n=n.substring(0,n.length-2))&&(e[i]=!0),n&&(t[i++]=n);return i<t.length&&(t.length=i),1<i?t:t[0]}function ve(n,e){if($(e))n=n[e];else for(let t=0;n&&t<e.length;t++)n=n[e[t]];return n}function Se(n,e,t,i,s){if(n=n[s],i===t.length-1)e[s]=n;else if(n)if(n.constructor===Array)for(e=e[s]=Array(n.length),s=0;s<n.length;s++)Se(n,e,t,i,s);else e=e[s]||(e[s]=x()),s=t[++i],Se(n,e,t,i,s)}function Te(n,e,t,i,s,r,o,l){if(n=n[o])if(i===e.length-1){if(n.constructor===Array){if(t[i]){for(e=0;e<n.length;e++)s.add(r,n[e],!0,!0);return}n=n.join(" ")}s.add(r,n,l,!0)}else if(n.constructor===Array)for(o=0;o<n.length;o++)Te(n,e,t,i,s,r,o,l);else o=e[++i],Te(n,e,t,i,s,r,o,l)}w=G.prototype;w.add=function(n,e,t){if(L(n)&&(e=n,n=ve(e,this.key)),e&&(n||n===0)){if(!t&&this.register[n])return this.update(n,e);for(let i=0,s,r;i<this.h.length;i++)r=this.h[i],s=this.K[i],$(s)&&(s=[s]),Te(e,s,this.A,0,this.index[r],n,s[0],t);if(this.I){let i=ve(e,this.I),s=x();$(i)&&(i=[i]);for(let r=0,o,l;r<i.length;r++)if(o=i[r],!s[o]&&(s[o]=1,l=this.l[o]||(this.l[o]=[]),!t||!l.includes(n))&&(l[l.length]=n,this.m)){const c=this.register[n]||(this.register[n]=[]);c[c.length]=l}}if(this.store&&(!t||!this.store[n])){let i;if(this.C){i=x();for(let s=0,r;s<this.C.length;s++)r=this.C[s],$(r)?i[r]=e[r]:Se(e,i,r,0,r[0])}this.store[n]=i||e}}return this};w.append=function(n,e){return this.add(n,e,!0)};w.update=function(n,e){return this.remove(n).add(n,e)};w.remove=function(n){if(L(n)&&(n=ve(n,this.key)),this.register[n]){for(var e=0;e<this.h.length&&(this.index[this.h[e]].remove(n,!this.o),!this.m);e++);if(this.I&&!this.m)for(let t in this.l){e=this.l[t];const i=e.indexOf(n);i!==-1&&(1<e.length?e.splice(i,1):delete this.l[t])}this.store&&delete this.store[n],delete this.register[n]}return this};w.search=function(n,e,t,i){t||(!e&&L(n)?(t=n,n=""):L(e)&&(t=e,e=0));let s=[],r=[],o,l,c,a,h,f,u=0;if(t)if(t.constructor===Array)c=t,t=null;else{if(n=t.query||n,c=(o=t.pluck)||t.index||t.field,a=t.tag,l=this.store&&t.enrich,h=t.bool==="and",e=t.limit||e||100,f=t.offset||0,a&&($(a)&&(a=[a]),!n)){for(let d=0,g;d<a.length;d++)(g=jn.call(this,a[d],e,f,l))&&(s[s.length]=g,u++);return u?s:[]}$(c)&&(c=[c])}c||(c=this.h),h=h&&(1<c.length||a&&1<a.length);const p=!i&&(this.o||this.async)&&[];for(let d=0,g,b,z;d<c.length;d++){let I;if(b=c[d],$(b)||(I=b,b=I.field,n=I.query||n,e=I.limit||e,l=I.enrich||l),p)p[d]=this.index[b].searchAsync(n,e,I||t);else{if(i?g=i[d]:g=this.index[b].search(n,e,I||t),z=g&&g.length,a&&z){const S=[];let P=0;h&&(S[0]=[g]);for(let D=0,Le,W;D<a.length;D++)Le=a[D],(z=(W=this.l[Le])&&W.length)&&(P++,S[S.length]=h?[W]:W);P&&(g=h?xt(S,e||100,f||0):On(g,S),z=g.length)}if(z)r[u]=b,s[u++]=g;else if(h)return[]}}if(p){const d=this;return new Promise(function(g){Promise.all(p).then(function(b){g(d.search(n,e,t,b))})})}if(!u)return[];if(o&&(!l||!this.store))return s[0];for(let d=0,g;d<r.length;d++){if(g=s[d],g.length&&l&&(g=vt.call(this,g)),o)return g;s[d]={field:r[d],result:g}}return s};function jn(n,e,t,i){let s=this.l[n],r=s&&s.length-t;if(r&&0<r)return(r>e||t)&&(s=s.slice(t,t+e)),i&&(s=vt.call(this,s)),{tag:n,result:s}}function vt(n){const e=Array(n.length);for(let t=0,i;t<n.length;t++)i=n[t],e[t]={id:i,doc:this.store[i]};return e}w.contain=function(n){return!!this.register[n]};w.get=function(n){return this.store[n]};w.set=function(n,e){return this.store[n]=e,this};w.searchCache=wt;w.export=function(n,e,t,i,s,r){let o;if(typeof r>"u"&&(o=new Promise(l=>{r=l})),s||(s=0),i||(i=0),i<this.h.length){const l=this.h[i],c=this.index[l];e=this,setTimeout(function(){c.export(n,e,s?l:"",i,s++,r)||(i++,s=1,e.export(n,e,l,i,s,r))})}else{let l,c;switch(s){case 1:l="tag",c=this.l,t=null;break;case 2:l="store",c=this.store,t=null;break;default:r();return}yt(n,this,t,l,i,s,c,r)}return o};w.import=function(n,e){if(e)switch($(e)&&(e=JSON.parse(e)),n){case"tag":this.l=e;break;case"reg":this.m=!1,this.register=e;for(let i=0,s;i<this.h.length;i++)s=this.index[this.h[i]],s.register=e,s.m=!1;break;case"store":this.store=e;break;default:n=n.split(".");const t=n[0];n=n[1],t&&n&&this.index[t].import(n,e)}};kt(G.prototype);var Fn={encode:St,F:!1,G:""};const Zn=[y("[√†√°√¢√£√§√•]"),"a",y("[√®√©√™√´]"),"e",y("[√¨√≠√Æ√Ø]"),"i",y("[√≤√≥√¥√µ√∂≈ë]"),"o",y("[√π√∫√ª√º≈±]"),"u",y("[√Ω≈∑√ø]"),"y",y("√±"),"n",y("[√ßc]"),"k",y("√ü"),"s",y(" & ")," and "];function St(n){var e=n=""+n;return e.normalize&&(e=e.normalize("NFD").replace(Dn,"")),dt.call(this,e.toLowerCase(),!n.normalize&&Zn)}var Un={encode:Tt,F:!1,G:"strict"};const Hn=/[^a-z0-9]+/,Xe={b:"p",v:"f",w:"f",z:"s",x:"s",√ü:"s",d:"t",n:"m",c:"k",g:"k",j:"k",q:"k",i:"e",y:"e",u:"o"};function Tt(n){n=St.call(this,n).join(" ");const e=[];if(n){const t=n.split(Hn),i=t.length;for(let s=0,r,o=0;s<i;s++)if((n=t[s])&&(!this.filter||!this.filter[n])){r=n[0];let l=Xe[r]||r,c=l;for(let a=1;a<n.length;a++){r=n[a];const h=Xe[r]||r;h&&h!==c&&(l+=h,c=h)}e[o++]=l}}return e}var Gn={encode:It,F:!1,G:""};const Qn=[y("ae"),"a",y("oe"),"o",y("sh"),"s",y("th"),"t",y("ph"),"f",y("pf"),"f",y("(?![aeo])h(?![aeo])"),"",y("(?!^[aeo])h(?!^[aeo])"),""];function It(n,e){return n&&(n=Tt.call(this,n).join(" "),2<n.length&&(n=se(n,Qn)),e||(1<n.length&&(n=gt(n)),n&&(n=n.split(" ")))),n||[]}var Kn={encode:Wn,F:!1,G:""};const Vn=y("(?!\\b)[aeo]");function Wn(n){return n&&(n=It.call(this,n,!0),1<n.length&&(n=n.replace(Vn,"")),1<n.length&&(n=gt(n)),n&&(n=n.split(" "))),n||[]}N["latin:default"]=Bn;N["latin:simple"]=Fn;N["latin:balance"]=Un;N["latin:advanced"]=Gn;N["latin:extra"]=Kn;const Jn={Document:G};class Xn{constructor(){this.name="search",this.index=new Jn.Document({document:{id:"id",index:["title","content"],store:!0}})}init(){console.log("Search Module Initialized"),v.on("note:create",e=>this.addToIndex(e)),v.on("note:save",e=>this.updateIndex(e)),v.on("db:delete",e=>{e.store===E.NOTES&&this.removeFromIndex(e.key)}),this.buildIndex(),v.on("search:query",e=>this.search(e))}async buildIndex(){const e=await Z.getAll(E.NOTES);e.forEach(t=>this.addToIndex(t)),console.log(`Search: Indexed ${e.length} notes`)}addToIndex(e){this.index.add(e)}updateIndex(e){this.index.update(e)}removeFromIndex(e){this.index.remove(e)}search(e){const t=this.index.search(e,{limit:10}),i=new Set;t.forEach(s=>{s.result.forEach(r=>i.add(r))}),console.log("Search Results:",t),v.emit("search:results",Array.from(i))}}const Ye=new Xn;class Yn{constructor(){this.modules=new Map,this.isInitialized=!1}async init(){if(!this.isInitialized){console.log(`Kernel: Booting ${Ne.name} v${Ne.version}...`);try{await Z.init(),console.log("Kernel: Database ready."),this.registerModule("editor",ye),ye.init(),this.registerModule("filesystem",be),be.init(),this.registerModule("search",Ye),Ye.init(),this.isInitialized=!0,v.emit("app:ready",{timestamp:Date.now()}),console.log("Kernel: System Ready.")}catch(e){console.error("Kernel: Boot failed",e),v.emit("app:error",e)}}}registerModule(e,t){this.modules.set(e,t),console.log(`Kernel: Module registered -> ${e}`)}}const ei=new Yn,ti="modulepreload",ni=function(n){return"/"+n},et={},ii=function(e,t,i){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");s=Promise.allSettled(t.map(c=>{if(c=ni(c),c in et)return;et[c]=!0;const a=c.endsWith(".css"),h=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=a?"stylesheet":ti,a||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),a)return new Promise((u,p)=>{f.addEventListener("load",u),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&r(l.reason);return e().catch(r)})},tt={render(){return`
            <div class="layout">
                <aside class="sidebar">
                    <div class="sidebar-header">
                        <h2>Notes</h2>
                        <button id="btn-new-note" class="icon-btn">+</button>
                    </div>
                    <nav id="file-tree" class="file-tree">
                        <!-- File Tree Injected Here -->
                        <div class="loading-placeholder">Loading...</div>
                    </nav>
                    <div class="sidebar-footer">
                        <button id="btn-settings" class="icon-btn">‚öôÔ∏è</button>
                    </div>
                </aside>
                <main class="main-content">
                    <div id="editor-container" class="editor-container">
                        <!-- Editor Injected Here -->
                        <div class="empty-state">Select a note to view</div>
                    </div>
                </main>
            </div>
        `},init(){const n=document.getElementById("btn-new-note");n&&n.addEventListener("click",()=>{ii(async()=>{const{bus:e}=await Promise.resolve().then(()=>Et);return{bus:e}},void 0).then(({bus:e})=>{e.emit("note:create",{title:"New Note",content:""})})})}};console.log("Typing Notes Platform v2.0 Initializing...");const si=document.querySelector("#app");v.on("app:ready",()=>{si.innerHTML=tt.render(),tt.init(),ye.mount("editor-container"),be.mount("file-tree")});ei.init();
